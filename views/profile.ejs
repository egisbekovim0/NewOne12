  <!DOCTYPE html>
  <html lang="en">
  <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Sign-In</title>
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
      <link rel="stylesheet" href="../css/headers.css">
      <link rel="stylesheet" href="../css/custom.css">
      <link rel="stylesheet" href="../css/customMenu.css">
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3">
      <link rel="stylesheet" href="../css/bootstrap.min.css">
      <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
      <style>
        .profile-progress-bar {
    width: 100%; 
    margin-bottom: 10px;
    list-style: none;
    padding: 0;
  }

  .profile-progress-bar li {
    margin: 15px 0;
    padding: 5px;
    display: flex;
    align-items: center;
  }

  .profile-progress-bar .bar {
    flex-grow: 1;
    margin-right: 10px;
    background: #353b48;
    display: block;
    height: 20px;
    border: 1px solid rgba(0, 0, 0, 0.3);
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);
    transition: all 0.3s cubic-bezier(.25, .8, .25, 1);
  }
  .profile-progress-bar .progress-text {
  margin-right: 10px;
}
.profile-progress-bar .attribute {
  font-size: 14px; 
  color: #555; 
}

  .profile-progress-bar .bar:hover {
    box-shadow: 0 14px 28px rgba(0, 0, 0, 0.25), 0 10px 10px rgba(0, 0, 0, 0.22);
  }

  .profile-progress-bar .bar span {
    height: 20px;
    float: left;
    background: linear-gradient(135deg, rgba(236, 0, 140, 1)0%, rgba(252, 103, 103,1)100%);
  }

  .profile-progress-bar .html {
    width: 90%;
  }

  .profile-progress-bar .css {
    width: 40%;
  }

  .profile-progress-bar .java {
    width: 70%;
  }

  .profile-progress-bar .python {
    width: 10%;
  }
      </style>
  </head>

  <body>
    <section id="profile">
      <header class="p-3 text-bg-dark">
        <div class="container">
          <div class="d-flex flex-wrap align-items-center justify-content-center justify-content-lg-start">
            <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0">
                <li class="list active">
                  <a href="/index">
                      <span class="icon">
                          <img src="../assets3/home.png" class="mb-3" width="30" height="30" alt="">
                      </span>
                      <span class="text"><%= __('home') %></span>
                  </a>
                </li>
                <li class="list">
                  <a href="/exercise">
                      <span class="icon">
                          <img src="../assets3/jogging.png" class="mb-3" width="30" height="30" alt="">
                      </span>
                      <span class="text"><%= __('exercises') %></span>
                  </a>
                </li>
                <li class="list">
                  <a href="/profile">
                      <span class="icon">
                          <img src="../assets3/exercise.png" class="mb-3" width="30" height="30" alt="">
                      </span>
                      <span class="text"><%= __('profile') %></span>
                  </a>
                </li>
                <li class="list">
                  <a href="/shop">
                      <span class="icon">
                          <img src="../assets3/store.png" class="mb-3" width="30" height="30" alt="">
                      </span>
                      <span class="text"><%= __('store') %></span>
                  </a>
                </li>
                <% if (user.role === 'admin') { %>
                  <li class="list">
                    <a href="/admin">
                        <span class="icon">
                            <img src="../assets3/adminka.png" class="mb-3" width="30" height="30" alt="">
                        </span>
                        <span class="text"><%= __('admin') %></span>
                    </a>
                  </li>
               
              <% } %>

                <li class="list">
                  <a href="/settings">
                      <span class="icon">
                          <img src="../assets3/settingsIcon.png" class="mb-3" width="30" height="30" alt="">
                      </span>
                      <span class="text"><%= __('settings') %></span>
                  </a>
                </li>
                <!-- <li class="list"><a><span class="icon">
                  <img src="../assets2/xppIcon.png" class="mb-3" width="30" height="30" alt="">
                </span><span class="text"><%= user ? user.xp : 'N/A' %></span></a></li> -->
                <li class="list"><a><span class="icon">
                  <img src="../assets2/coinI.png" class="mb-3" width="30" height="30" alt="">
                </span><span class="text"><%= user ? user.money : 'N/A' %></span></a></li>
              
            </ul>

            <div class="dropdown">
              <button class="btn btn-secondary dropdown-toggle" type="button" id="languageDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                <%= __('language') %>
              </button>
              <ul class="dropdown-menu" aria-labelledby="languageDropdown">
                <li><a class="dropdown-item" href="?lang=<%= i18n.getLocale()  === 'ru' ? 'en' : i18n.getLocale() %>">English</a></li>
                <li><a class="dropdown-item" href="?lang=ru">Русский</a></li>
              </ul>
            </div>
    
            <form class="col-12 col-lg-auto mb-3 mb-lg-0 me-lg-3" role="search">
              <input type="search" id="profileExerciseSearchInput" class="form-control form-control-dark text-bg-dark" placeholder="Search..." aria-label="Search">
            </form>
    
            <div class="text-end">
              <a href="/login"><button type="button" class="custom-btn me-2"><%= __('login') %></button></a>
              <a href="/register"><button type="button" class="custom-btn"><%= __('signup') %></button></a>
            </div>
          </div>
        </div>
      </header>

        <div id="hunger" style="display: none;"><%= user.hunger %></div>
        <div id="health" style="display: none;"><%= user.health %></div>
        <div id="money" style="display: none;"><%= user.money %></div>
        <div id="experience" style="display: none;"><%= user.xp %></div>
    
     
      <div class="container">
          <div class="row">
            <div class="col-md-6 offset-md-3">
              <h1 class="text-center text-glow"><%= __('profilePage') %></h1>
              <hr>
              <div class="card">
                <div class="card-body">
                  <h4 class="card-title"><span id="username"><%= user ? user.name : 'N/A' %></span></h4>
                  <p class="card-text"><span id="email"><%= user ? user.email : 'N/A' %></span></p>
                  <p class="card-text"><%= __('userLevel') %><span id="user_level"><%= user ? user.user_level : 'N/A' %></span></p>    
                  <!-- <p class="card-text">User hunger: <span id="user_level"><%= user ? user.hunger : 'N/A' %></span></p>             -->
                  <div class="profile-progress-bar">
                    <li>
                      <img src="../assets3/heart-rate.png" class="mb-3" style="width: 30px; height: 30px;" alt="">
                      <span id="healthText" class="progress-text"></span>
                      <span class="bar">
                        <span id="healthBar" class="html"></span>
                      </span>
                     
                      <span class="attribute"><%= __('health') %></span>
                    </li>
                    <li><img src="../assets2/hunger.png" class="mb-3" style="width: 30px; height: 30px;" alt="">
                      <span id="hungerText" class="progress-text"></span>
                      <span class="bar"><span id="hungerBar" class="css"></span></span>
                    
                      <span class="attribute"><%= __('hunger') %></span>
                    </li>
                    <li><img src="../assets2/xppIcon.png" class="mb-3" style="width: 30px; height: 30px;" alt="">
                      <span id="xpText" class="progress-text"></span>
                      <span class="bar"><span id="xpBar" class="java"></span></span>
                
                      <span class="attribute"><%= __('xpText') %></span>
                    </li>
                  </div>
                </div>
              </div>
            </div>
          </div>
      </div>
    </section>
    <section id="exercises">
          <div class="container>">
            <div class="row">
              <div id="exerciseContainer">
          
              </div>
            </div>
          </div>

    </section>

      
      <script>
          $(document).ready(function() {
      
            $('#profileExerciseSearchInput').on('input', function () {
              const exerciseName = $(this).val();
              searchExercisesForProf(exerciseName);
            });

            fetchAllExercisesForProf()

          });

          function searchExercisesForProf(exerciseName) {
            if (exerciseName.trim() === '') {
              
              fetchAllExercisesForProf();
          } else {
            $.ajax({
              type: 'POST',
              url: '/api/user/searchExercisesForProfile', 
              contentType: 'application/json',
              data: JSON.stringify({ exerciseName: exerciseName }),
              success: function (response) {
                  $('#exerciseContainer').html(response);
              },
              error: function (error) {
                console.error(error);
              }
            });
            }
          }
          
          function fetchAllExercisesForProf() {
        
            $.ajax({
              type: 'POST',
              url: '/api/user/fetchAllExercisesForProfile', 
              contentType: 'application/json',
              success: function (response) {
                  $('#exerciseContainer').html(response);
              },
              error: function (error) {
                  console.error(error);
              }
            });
          }

  
        const hungerData = parseFloat(document.getElementById("hunger").innerText)
        const healthData = parseFloat(document.getElementById("health").innerText)
        const moneyData = parseFloat(document.getElementById("money").innerText)
        const xpData = parseFloat(document.getElementById("experience").innerText)
        const userLevel = parseInt(document.getElementById("user_level").innerText)

        const maxHealthWidth = 100;
        const maxHungerWidth = 100;

        const healthBarWidth = (healthData / maxHealthWidth) * 100 + '%';
        console.log(healthBarWidth)
        $('#healthBar').css('width', healthBarWidth);
        $('#healthText').text(`${healthData}/${maxHealthWidth}`);
        
        const hungerBarWidth = (hungerData / maxHungerWidth) * 100 + '%';
        $('#hungerBar').css('width', hungerBarWidth);
        $('#hungerText').text(`${hungerData}/${maxHungerWidth}`);

        let maxXP;
        if (userLevel === 1) {
          maxXP = 1000;
        } else {
          maxXP = 1500;
        }

        const xpBarWidth = (xpData / maxXP) * 100 + '%';
        $('#xpBar').css('width', xpBarWidth);
        $('#xpText').text(`${xpData}/${maxXP}`);
      </script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
  </body>
  </html>